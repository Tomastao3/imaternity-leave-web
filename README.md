# 产假计算系统

一个基于 React 的产假计算系统，提供产假周期、津贴和社保公积金扣除的计算功能。

## 功能特性

### 1. 产假天数计算 🆕
- **输入**: 城市、员工工号、产假起止日期、是否难产、胎数、怀孕时间段
- **输出**: 根据城市规则自动计算的产假天数、适用规则明细、产假周期
- **特色**: 
  - 自动加载城市产假规则和员工基础信息
  - 智能计算法定产假、难产假、多胞胎假、奖励假、流产假
  - 支持手动调整产假条件或使用员工档案信息

### 2. 产假津贴计算 🆕
- **输入**: 公司平均工资、社保3倍上限（可以支持配置多个城市）、员工基本工资、津贴发放方式
- **输出**: 
  - 社保缴费基数
  - 日津贴标准
  - 产假津贴总额
  - 公司应发工资
  - 公司补差金额
  - 个人补交社保（津贴发放到个人账户时）
  - 实际补差金额（扣除个人补交社保后）
  - 员工实际可得金额

### 3. 社保公积金扣除计算
- **输入**: 公司平均工资、社保3倍上限、员工平均工资、产假天数
- **输出**:
  - 月度扣除标准（养老、医疗、失业保险、住房公积金）
  - 产假期间实际扣除金额

### 4. 批量产假计算 🆕
- **功能**: Excel批量导入员工数据，智能计算产假天数和津贴补差
- **支持操作**:
  - 下载标准Excel模板
  - 批量导入员工基础信息（工号、请假日期、是否难产等）
  - 自动计算产假天数（根据城市规则和员工情况）
  - 智能计算公司补差金额（基于申报工资和社保津贴）
  - 计算个人补交社保金额（津贴发放到个人账户时）
  - 导出详细计算结果到Excel
  - 错误数据验证和报告

### 5. 城市数据管理 🆕
- **功能**: 管理多城市的产假规则、津贴规则和员工信息
- **支持操作**:
  - **产假规则表**: 城市、产假类型（法定产假、难产假、多胞胎、奖励假、流产假）、产假天数、是否顺延标记、是否包含工作日标记
  - **津贴规则表**: 城市、社平工资、公司平均工资、账户类型（公司/个人）
  - **员工信息表**: 工号、基本工资、社保基数、是否难产、胎数、时间段（7个月以上、4个月以上7个月以下、4个月以下）
  - Excel/CSV批量导入导出功能
  - 数据验证和错误处理
  - 按城市筛选和管理数据

## 技术栈

- React 18.2.0
- date-fns (日期处理)
- xlsx (Excel文件处理)
- file-saver (文件下载)
- CSS3 (响应式设计)

## 安装和运行

1. 安装依赖:
```bash
npm install
```

2. 启动开发服务器:
```bash
npm start
```

3. 在浏览器中打开 [http://localhost:3000](http://localhost:3000)

## 项目结构

```
src/
├── components/
│   ├── MaternityPeriodCalculator.js    # 产假周期计算组件
│   ├── AllowanceCalculator.js          # 产假津贴计算组件
│   ├── DeductionCalculator.js          # 社保公积金扣除计算组件
│   └── BatchProcessor.js               # 批量处理组件 🆕
├── utils/
│   ├── batchCalculations.js            # 批量计算工具函数 🆕
│   └── excelUtils.js                   # Excel处理工具函数 🆕
├── App.js                              # 主应用组件
├── index.js                            # 应用入口
└── index.css                           # 全局样式
```

## 计算规则

### 产假津贴计算规则
- 社保缴费基数 = min(社保3倍上限, 员工基本工资)
- 日津贴 = 社保缴费基数 / 30
- 产假津贴 = 日津贴 × 产假天数
- 公司应发工资 = 公司平均工资 / 30 × 产假天数
- 公司补差金额 = max(0, 公司应发工资 - 产假津贴)
- 个人补交社保 = 公司平均工资 / 30 × 产假天数 × 个人社保费率（津贴发放到个人账户时）
- 实际补差金额 = 公司补差金额 - 个人补交社保（津贴发放到个人账户时）
- 员工实际可得 = 产假津贴 + 实际补差金额

### 批量产假计算规则 🆕
- **产假天数自动计算**: 根据城市规则、是否难产、胎数等自动计算
- **公司补差计算**: 以公司申报工资为基数，超出社保津贴部分由公司补差
- **个人补交社保**: 
  - 津贴发放到个人账户时：需计算员工社保个人部分
  - 津贴发放到企业账户时：无需计算个人补交
  - 个人补交金额 = (养老8% + 医疗2% + 失业0.5% + 公积金12%) × 申报工资 × 产假天数/30
  - 实际补差 = 公司补差 - 个人补交社保（津贴到个人时）

### 社保公积金扣除规则
- 养老保险: 8%
- 医疗保险: 2%
- 失业保险: 0.5%
- 住房公积金: 12%
- 扣除金额 = 月度标准 × (产假天数 / 30)

## 批量产假计算使用指南 🆕

### 1. 下载Excel模板
- 点击"下载Excel模板"按钮获取标准格式的数据模板
- 模板包含两个工作表：员工数据模板和填写说明

### 2. 填写员工数据
**必填字段：**
- 员工工号：员工的唯一工号（系统将自动匹配员工信息）
- 员工姓名：员工的真实姓名
- 城市：员工所在城市（用于匹配产假规则）
- 请假开始日期：格式为YYYY-MM-DD，如2024-01-15
- 公司申报工资：员工的公司申报工资基数（元）
- 津贴发放方式：个人账户/企业账户

**可选字段：**
- 是否难产：是/否，默认为否
- 胎数：1/2/3等，默认为1
- 怀孕时间段：7个月以上/4-7个月/4个月以下，默认7个月以上
- 部门：员工所在部门
- 职位：员工职位
- 备注：其他说明信息

### 3. 批量处理流程
1. 选择填写好的Excel文件
2. 系统自动预览前5条数据并验证格式
3. 点击"开始批量处理"进行计算
4. 系统自动计算产假天数、津贴补差、个人补交社保
5. 查看处理结果摘要
6. 点击"导出结果"下载完整报告

### 4. 结果文件说明
导出的Excel文件包含以下字段：
- **员工工号**：员工唯一标识
- **员工姓名**：员工真实姓名  
- **产假天数**：根据城市规则自动计算的产假天数
- **公司补差金额**：公司需要补差的金额
- **个人补交社保金额**：员工需要补交的社保个人部分（津贴到个人时）
- **实际补差金额**：扣除个人补交社保后的实际补差
- **计算明细**：详细的计算过程和规则说明
- **错误信息**：处理失败的数据及错误原因

## 特性

- 📱 响应式设计，支持移动端
- 🎨 现代化 UI 界面
- ⚡ 实时计算结果
- 🔄 一键重置功能
- 📊 详细的计算结果展示
- 📥 Excel批量导入导出
- ✅ 数据验证和错误报告
- 📈 处理结果统计分析

## 浏览器支持

- Chrome (推荐)
- Firefox
- Safari
- Edge
